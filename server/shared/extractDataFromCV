const { TextServiceClient } =
  require("@google-ai/generativelanguage").v1beta2;

const { GoogleAuth } = require("google-auth-library");
const MODEL_NAME = "models/text-bison-001";
const API_KEY = "AIzaSyDRSSB98nK78iOssd_Mwm-vJc47foqjwZk"

const client = new TextServiceClient({
  authClient: new GoogleAuth().fromAPIKey(API_KEY),
});

const cv_category = "Tester"

const promptInfo = `Please provide me with the information regarding the name, github link and email address of the candidate mentioned in the CV: `
const promptExp = `Extract from the following CV to get the part about work experience corresponding to the job ${cv_category} (company name, working position, working period (from ... to ...), job description) : `
const promptSkill = `Extract information from the CV about the candidate's skills (programming skills) for job ${cv_category}: `
const promptLang = `Extract information about the candidate's English qualifications listed in the following CV: `
const promptProject = `Among the projects that the candidate mentioned in the following CV, please extract all information about the 2 projects most relevant to the job ${cv_category}: `

const cv = `
PROFILE
 namthse01@gmail.com
 0396258901
 https://github.com/namthse01
 Binh Thanh District, HCM city, Viet Nam
SKILLS
PROGRAMMING
C#.NetCore/ FrameWork
Java
Reactjs, Javascript, Nodejs
DATABASE
Microsoft SQl Sever, MySQL
EXPERIENCED WITH
Git, Microsoft Azure
LANGUAGE
English
TRAN HOANG NAM
DEVELOPER
ABOUT ME
As a fresher developer with a diverse skill set, I am proficient in utilizing ReactJS,
ASP.Net, JavaScript, and Java OOP concepts to develop efficient and interactive
web applications. ReactJS for building dynamic user interfaces and ASP.Net for
creating robust server-side applications. Additionally, my knowledge of
JavaScript enables me to add functionality and interactivity to websites, while
my understanding of Java OOP principles allows me to develop scalable and
maintainable code structures. With a passion for continuous learning and
problem-solving, I am excited to apply my skills and contribute to innovative
projects in the software development industry..
WORK EXPERIENCE
 TESTER INTERN // Jan 2021 - Apr 2021
FPT Sofware HCM
Health Care Medical Sofware
Team Number: 10
Main responsibilities:
• Involves identifying and fixing bugs to ensure the smooth functioning of the
software system.
• Bug Identification, Bug Reproduction, Documentation
PROJECT
 FURNITURE REPAIR AND MAINTENANCE SERVICE // Jan 2023 - Apr 2023
Position: Front-end developer
The Furniture Repair and Maintenance Service project aims to provide a
convenient and platform for customers to access top-quality furniture repair
and maintenance services. By connecting customers with skilled craftsmen, this
platform ensures that furniture repairs are carried out efficiently and to the
highest standards.
Team Number: 3
Tech: Reactjs, .NetCore 3.0, Flutter, Microsoft SQL Server
Main responsibilities:
• Making web-admin for manager to manage customer order and employee.
 DENTIST APPOINTMENT SYSTEM // Jul 2023 - Aug 2023
Position: Back-end developer and Front-end support
The Dental Booking Website project aims to provide a convenient and efficient
platform for patients to book dental appointments online. This website will
streamline the process of scheduling appointments, allowing users to easily find
and book appointments with their preferred dentists.
Team Number: 2
Tech: Reactjs, .NetCore 5.0, Microsoft SQL Server
Main responsibilities:
• Write SQL script
• Making API with .Net Core 5.0
 GYM EXERCISE // Aug 2023 - Sep2023
Position: Back-end developer and Front-end support
The Gym Exercise Website project aims to provide a convenient and efficient
platform for everyone to see an exercise to start practice. This website will target
the detail for your abs praactice, videos and exercise that target the same
muscle group, equipment group
Team Number: 1
Tech: Reactjs
Main responsibilities:
• Make a gym exercise website using reactjs and mui library
 WEB ADMIN REACTJS // Jul 2023 - Aug 2023
Position: Front-end developer
A web-admin platform using reactjs and reactjs library such as mui, fullcalendar
,formik to create a web-admin having a dashboard, calendar, light/dark mode,
team manage table.
Team Number: 1
Tech: Reactjs
Main responsibilities:
• Making web-admin for manager to manage customer and employee.
EDUCATION
 SOFTWARE ENGINEER // 2018 - 2023
FPT University
CERTIFICATIONS
Major Software Engineering - Information System
2023 Bachelor in Software Engineering - FPT Unversity HCM
English: TOIEC: 600
`

const extractData = async (prompt, cv) => {
  const combined_prompt = `${prompt} "${cv}"`
  let generatedText = "";
  try {
    const res = await client.generateText({
      model: MODEL_NAME,
      prompt: {
        text: combined_prompt,
      },
    });
    generatedText = res[0].candidates[0].output;
    return generatedText;
  } catch (err) {
    console.log(err);
    return "";
  }
}

const getUserData = async (text) => {
  const info = await extractData(promptInfo, text);
  const exp = await extractData(promptExp, text);
  const skill = await extractData(promptSkill, text);
  const lang = await extractData(promptLang, text);
  const project = await extractData(promptProject, text);
  const res = info + '\n' + exp + '\n' + skill + '\n' + lang + '\n' + project + '\n'
  return res;
}

export default getUserData